<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Booking Platform</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            color: #333;
        }

        .container {
            display: flex;
            min-height: 100vh;
        }

        .sidebar {
            width: 260px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
        }

        .sidebar h2 {
            margin-bottom: 30px;
            font-size: 24px;
        }

        .sidebar ul {
            list-style: none;
        }

        .sidebar ul li {
            margin: 15px 0;
        }

        .sidebar ul li a {
            color: white;
            text-decoration: none;
            padding: 10px 15px;
            border-radius: 5px;
            display: block;
            transition: all 0.3s;
            cursor: pointer;
        }

        .sidebar ul li a:hover,
        .sidebar ul li a.active {
            background: rgba(255, 255, 255, 0.2);
        }

        .main-content {
            margin-left: 260px;
            flex: 1;
            padding: 30px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            color: #667eea;
        }

        .logout-btn {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }

        .logout-btn:hover {
            background: #ee5a5a;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .stat-card h3 {
            color: #999;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .stat-card .number {
            font-size: 32px;
            font-weight: bold;
            color: #667eea;
        }

        .section {
            display: none;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .section.active {
            display: block;
        }

        .section h2 {
            color: #667eea;
            margin-bottom: 20px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        table thead {
            background: #f5f5f5;
        }

        table th {
            padding: 12px;
            text-align: left;
            font-weight: 600;
            color: #667eea;
        }

        table td {
            padding: 12px;
            border-bottom: 1px solid #eee;
        }

        table tr:hover {
            background: #f9f9f9;
        }

        .status-badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-confirmed {
            background: #d1ecf1;
            color: #0c5460;
        }

        .status-completed {
            background: #d4edda;
            color: #155724;
        }

        .status-cancelled {
            background: #f8d7da;
            color: #721c24;
        }

        .status-open {
            background: #fff3cd;
            color: #856404;
        }

        .status-resolved {
            background: #d4edda;
            color: #155724;
        }

        .priority-high {
            color: #ff6b6b;
            font-weight: 600;
        }

        .priority-medium {
            color: #ffa500;
            font-weight: 600;
        }

        .priority-low {
            color: #28a745;
            font-weight: 600;
        }

        .action-btn {
            padding: 6px 12px;
            margin: 0 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }

        .btn-view {
            background: #667eea;
            color: white;
        }

        .btn-view:hover {
            background: #5568d3;
        }

        .btn-resolve {
            background: #28a745;
            color: white;
        }

        .btn-resolve:hover {
            background: #218838;
        }

        .btn-delete {
            background: #ff6b6b;
            color: white;
        }

        .btn-delete:hover {
            background: #ee5a5a;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.4);
        }

        .modal.show {
            display: block;
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 20px;
            border-radius: 10px;
            width: 80%;
            max-width: 600px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-close {
            float: right;
            font-size: 28px;
            font-weight: bold;
            color: #aaa;
            cursor: pointer;
        }

        .modal-close:hover {
            color: #000;
        }

        .form-group {
            margin: 15px 0;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: inherit;
            font-size: 14px;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .btn-submit {
            background: #667eea;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            width: 100%;
        }

        .btn-submit:hover {
            background: #5568d3;
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: #999;
        }

        .search-box {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
        }

        .search-box input {
            flex: 1;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        .search-box button {
            background: #667eea;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }

        .alert {
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
            display: none;
        }

        .alert.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            display: block;
        }

        .alert.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            display: block;
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 200px;
            }

            .main-content {
                margin-left: 200px;
                padding: 15px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            table {
                font-size: 12px;
            }

            table th, table td {
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <h2>üéØ Admin Panel</h2>
            <ul>
                <li><a class="nav-link active" data-section="dashboard">üìä Dashboard</a></li>
                <li><a class="nav-link" data-section="users">üë• Users</a></li>
                <li><a class="nav-link" data-section="bookings">üìÖ Bookings</a></li>
                <li><a class="nav-link" data-section="contacts">üìû Contact Messages</a></li>
                <li><a class="nav-link" data-section="complaints">‚ö†Ô∏è Complaints</a></li>
                <li><a class="nav-link" data-section="halls">üèõÔ∏è Wedding Halls</a></li>
                <li><a class="nav-link" data-section="hotels">üè® Hotel Rooms</a></li>
                <li><a class="nav-link" data-section="shopping">üõçÔ∏è Shopping Items</a></li>
                <li style="margin-top: 40px; border-top: 1px solid rgba(255,255,255,0.2); padding-top: 20px;">
                    <button class="logout-btn" onclick="logout()" style="width: 100%; background: #ff6b6b; border: none; padding: 10px; border-radius: 5px;">üö™ Logout</button>
                </li>
            </ul>
        </div>

        <div class="main-content">
            <div class="header">
                <h1>üìä Admin Dashboard</h1>
                <span id="user-info" style="font-weight: 600;"></span>
            </div>

            <div id="alert" class="alert"></div>

            <!-- DASHBOARD SECTION -->
            <div id="dashboard" class="section active">
                <h2>Dashboard Overview</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>Total Users</h3>
                        <div class="number" id="stat-users">-</div>
                    </div>
                    <div class="stat-card">
                        <h3>Total Bookings</h3>
                        <div class="number" id="stat-bookings">-</div>
                    </div>
                    <div class="stat-card">
                        <h3>Total Revenue</h3>
                        <div class="number" id="stat-revenue">-</div>
                    </div>
                    <div class="stat-card">
                        <h3>Pending Complaints</h3>
                        <div class="number" id="stat-complaints">-</div>
                    </div>
                    <div class="stat-card">
                        <h3>Contact Messages</h3>
                        <div class="number" id="stat-contacts">-</div>
                    </div>
                    <div class="stat-card">
                        <h3>Unread Contacts</h3>
                        <div class="number" id="stat-unread">-</div>
                    </div>
                </div>
            </div>

            <!-- USERS SECTION -->
            <div id="users" class="section">
                <h2>Users Management</h2>
                <div id="users-list"></div>
            </div>

            <!-- BOOKINGS SECTION -->
            <div id="bookings" class="section">
                <h2>All Bookings</h2>
                <div class="search-box">
                    <input type="text" id="booking-search" placeholder="Search bookings...">
                    <button onclick="filterBookings()">Search</button>
                </div>
                <div id="bookings-list"></div>
            </div>

            <!-- CONTACTS SECTION -->
            <div id="contacts" class="section">
                <h2>Contact Messages</h2>
                <div id="contacts-list"></div>
            </div>

            <!-- COMPLAINTS SECTION -->
            <div id="complaints" class="section">
                <h2>User Complaints</h2>
                <div id="complaints-list"></div>
            </div>

            <!-- WEDDING HALLS SECTION -->
            <div id="halls" class="section">
                <h2>Wedding Halls Management</h2>
                <button class="action-btn btn-view" onclick="showAddHallForm()">+ Add New Hall</button>
                <div id="halls-list"></div>
            </div>

            <!-- HOTELS SECTION -->
            <div id="hotels" class="section">
                <h2>Hotel Rooms Management</h2>
                <button class="action-btn btn-view" onclick="showAddHotelForm()">+ Add New Room</button>
                <div id="hotels-list"></div>
            </div>

            <!-- SHOPPING SECTION -->
            <div id="shopping" class="section">
                <h2>Shopping Items Management</h2>
                <button class="action-btn btn-view" onclick="showAddItemForm()">+ Add New Item</button>
                <div id="shopping-list"></div>
            </div>
        </div>
    </div>

    <!-- MODALS -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal()">&times;</span>
            <div id="modal-body"></div>
        </div>
    </div>

    <script>
        const API_BASE = 'https://booking-platform-api1.onrender.com/api';

        // Check if user is authenticated
        async function checkAuth() {
            try {
                const res = await fetch(`${API_BASE}/auth/me`, {
                    credentials: 'include'
                });
                
                if (!res.ok) {
                    window.location.href = 'login.html';
                    return;
                }
                
                const user = await res.json();
                document.getElementById('user-info').textContent = `üë§ ${user.full_name}`;
                
                if (!user.is_admin) {
                    alert('Admin access required');
                    window.location.href = 'index.html';
                }
            } catch (error) {
                console.error('Auth error:', error);
                window.location.href = 'login.html';
            }
        }

        // Load dashboard
        async function loadDashboard() {
            try {
                const res = await fetch(`${API_BASE}/admin/dashboard`, {
                    credentials: 'include'
                });
                const data = await res.json();
                
                document.getElementById('stat-users').textContent = data.total_users;
                document.getElementById('stat-bookings').textContent = data.total_bookings;
                document.getElementById('stat-revenue').textContent = `‚Çπ${data.total_revenue.toLocaleString()}`;
                document.getElementById('stat-complaints').textContent = data.pending_complaints;
                document.getElementById('stat-contacts').textContent = data.total_contacts;
                document.getElementById('stat-unread').textContent = data.unread_contacts;
            } catch (error) {
                showAlert('Error loading dashboard', 'error');
            }
        }

        // Load users
        async function loadUsers() {
            try {
                const res = await fetch(`${API_BASE}/admin/users`, {
                    credentials: 'include'
                });
                const users = await res.json();
                
                if (users.length === 0) {
                    document.getElementById('users-list').innerHTML = '<div class="empty-state">No users found</div>';
                    return;
                }
                
                let html = '<table><thead><tr><th>ID</th><th>Username</th><th>Email</th><th>Phone</th><th>Joined</th></tr></thead><tbody>';
                users.forEach(user => {
                    html += `<tr>
                        <td>${user.id}</td>
                        <td>${user.username}</td>
                        <td>${user.email}</td>
                        <td>${user.phone}</td>
                        <td>${new Date(user.created_at).toLocaleDateString()}</td>
                    </tr>`;
                });
                html += '</tbody></table>';
                document.getElementById('users-list').innerHTML = html;
            } catch (error) {
                showAlert('Error loading users', 'error');
            }
        }

        // Load bookings
        async function loadBookings() {
            try {
                const res = await fetch(`${API_BASE}/admin/bookings`, {
                    credentials: 'include'
                });
                const bookings = await res.json();
                
                if (bookings.length === 0) {
                    document.getElementById('bookings-list').innerHTML = '<div class="empty-state">No bookings found</div>';
                    return;
                }
                
                let html = '<table><thead><tr><th>ID</th><th>Type</th><th>User</th><th>Check-in</th><th>Check-out</th><th>Price</th><th>Status</th><th>Payment</th></tr></thead><tbody>';
                bookings.forEach(booking => {
                    html += `<tr>
                        <td>${booking.id}</td>
                        <td>${booking.booking_type}</td>
                        <td>User #${booking.user_id}</td>
                        <td>${booking.check_in_date}</td>
                        <td>${booking.check_out_date}</td>
                        <td>‚Çπ${booking.total_price}</td>
                        <td><span class="status-badge status-${booking.status}">${booking.status}</span></td>
                        <td><span class="status-badge status-${booking.payment_status}">${booking.payment_status}</span></td>
                    </tr>`;
                });
                html += '</tbody></table>';
                document.getElementById('bookings-list').innerHTML = html;
            } catch (error) {
                showAlert('Error loading bookings', 'error');
            }
        }

        // Load contacts
        async function loadContacts() {
            try {
                const res = await fetch(`${API_BASE}/admin/contacts`, {
                    credentials: 'include'
                });
                const contacts = await res.json();
                
                if (contacts.length === 0) {
                    document.getElementById('contacts-list').innerHTML = '<div class="empty-state">No contact messages</div>';
                    return;
                }
                
                let html = '<table><thead><tr><th>ID</th><th>Name</th><th>Email</th><th>Message</th><th>Status</th><th>Action</th></tr></thead><tbody>';
                contacts.forEach(contact => {
                    html += `<tr>
                        <td>${contact.id}</td>
                        <td>${contact.name}</td>
                        <td>${contact.email}</td>
                        <td>${contact.message.substring(0, 50)}...</td>
                        <td><span class="status-badge status-${contact.status}">${contact.status}</span></td>
                        <td><button class="action-btn btn-resolve" onclick="resolveContact(${contact.id})">Resolve</button></td>
                    </tr>`;
                });
                html += '</tbody></table>';
                document.getElementById('contacts-list').innerHTML = html;
            } catch (error) {
                showAlert('Error loading contacts', 'error');
            }
        }

        // Load complaints
        async function loadComplaints() {
            try {
                const res = await fetch(`${API_BASE}/admin/complaints`, {
                    credentials: 'include'
                });
                const complaints = await res.json();
                
                if (complaints.length === 0) {
                    document.getElementById('complaints-list').innerHTML = '<div class="empty-state">No complaints</div>';
                    return;
                }
                
                let html = '<table><thead><tr><th>ID</th><th>Type</th><th>Subject</th><th>Priority</th><th>Status</th><th>Action</th></tr></thead><tbody>';
                complaints.forEach(complaint => {
                    html += `<tr>
                        <td>${complaint.id}</td>
                        <td>${complaint.complaint_type}</td>
                        <td>${complaint.subject}</td>
                        <td><span class="priority-${complaint.priority.toLowerCase()}">${complaint.priority}</span></td>
                        <td><span class="status-badge status-${complaint.status}">${complaint.status}</span></td>
                        <td><button class="action-btn btn-view" onclick="viewComplaint(${complaint.id})">View</button></td>
                    </tr>`;
                });
                html += '</tbody></table>';
                document.getElementById('complaints-list').innerHTML = html;
            } catch (error) {
                showAlert('Error loading complaints', 'error');
            }
        }

        // Load halls
        async function loadHalls() {
            try {
                const res = await fetch(`${API_BASE}/wedding-halls`, {
                    credentials: 'include'
                });
                const halls = await res.json();
                
                if (halls.length === 0) {
                    document.getElementById('halls-list').innerHTML = '<div class="empty-state">No wedding halls</div>';
                    return;
                }
                
                let html = '<table><thead><tr><th>ID</th><th>Name</th><th>Location</th><th>Capacity</th><th>Price/Day</th><th>Rating</th></tr></thead><tbody>';
                halls.forEach(hall => {
                    html += `<tr>
                        <td>${hall.id}</td>
                        <td>${hall.name}</td>
                        <td>${hall.location}</td>
                        <td>${hall.capacity}</td>
                        <td>‚Çπ${hall.price_per_day}</td>
                        <td>‚≠ê ${hall.rating}</td>
                    </tr>`;
                });
                html += '</tbody></table>';
                document.getElementById('halls-list').innerHTML = html;
            } catch (error) {
                showAlert('Error loading halls', 'error');
            }
        }

        // Load hotels
        async function loadHotels() {
            try {
                const res = await fetch(`${API_BASE}/hotel-rooms`, {
                    credentials: 'include'
                });
                const rooms = await res.json();
                
                if (rooms.length === 0) {
                    document.getElementById('hotels-list').innerHTML = '<div class="empty-state">No hotel rooms</div>';
                    return;
                }
                
                let html = '<table><thead><tr><th>ID</th><th>Hotel</th><th>Room Type</th><th>Capacity</th><th>Price/Night</th><th>Available</th></tr></thead><tbody>';
                rooms.forEach(room => {
                    html += `<tr>
                        <td>${room.id}</td>
                        <td>${room.hotel_name}</td>
                        <td>${room.room_type}</td>
                        <td>${room.capacity}</td>
                        <td>‚Çπ${room.price_per_night}</td>
                        <td>${room.available ? '‚úÖ Yes' : '‚ùå No'}</td>
                    </tr>`;
                });
                html += '</tbody></table>';
                document.getElementById('hotels-list').innerHTML = html;
            } catch (error) {
                showAlert('Error loading hotels', 'error');
            }
        }

        // Load shopping items
        async function loadShopping() {
            try {
                const res = await fetch(`${API_BASE}/shopping-items`, {
                    credentials: 'include'
                });
                const items = await res.json();
                
                if (items.length === 0) {
                    document.getElementById('shopping-list').innerHTML = '<div class="empty-state">No shopping items</div>';
                    return;
                }
                
                let html = '<table><thead><tr><th>ID</th><th>Name</th><th>Category</th><th>Price</th><th>Stock</th><th>Vendor</th></tr></thead><tbody>';
                items.forEach(item => {
                    html += `<tr>
                        <td>${item.id}</td>
                        <td>${item.name}</td>
                        <td>${item.category}</td>
                        <td>‚Çπ${item.price}</td>
                        <td>${item.stock}</td>
                        <td>${item.vendor}</td>
                    </tr>`;
                });
                html += '</tbody></table>';
                document.getElementById('shopping-list').innerHTML = html;
            } catch (error) {
                showAlert('Error loading items', 'error');
            }
        }

        // Resolve contact
        async function resolveContact(contactId) {
            try {
                const res = await fetch(`${API_BASE}/admin/contacts/${contactId}/resolve`, {
                    method: 'POST',
                    credentials: 'include'
                });
                
                if (res.ok) {
                    showAlert('Contact marked as resolved', 'success');
                    loadContacts();
                }
            } catch (error) {
                showAlert('Error resolving contact', 'error');
            }
        }

        // View complaint details
        async function viewComplaint(complaintId) {
            try {
                const res = await fetch(`${API_BASE}/admin/complaints`, {
                    credentials: 'include'
                });
                const complaints = await res.json();
                const complaint = complaints.find(c => c.id === complaintId);
                
                if (!complaint) return;
                
                let html = `
                    <h3>Complaint #${complaint.id}</h3>
                    <div class="form-group">
                        <label>Type:</label>
                        <input type="text" value="${complaint.complaint_type}" readonly>
                    </div>
                    <div class="form-group">
                        <label>Subject:</label>
                        <input type="text" value="${complaint.subject}" readonly>
                    </div>
                    <div class="form-group">
                        <label>Description:</label>
                        <textarea readonly>${complaint.description}</textarea>
                    </div>
                    <div class="form-group">
                        <label>Priority:</label>
                        <select id="priority">
                            <option ${complaint.priority === 'low' ? 'selected' : ''}>low</option>
                            <option ${complaint.priority === 'medium' ? 'selected' : ''}>medium</option>
                            <option ${complaint.priority === 'high' ? 'selected' : ''}>high</option>
                            <option ${complaint.priority === 'urgent' ? 'selected' : ''}>urgent</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Status:</label>
                        <select id="status">
                            <option ${complaint.status === 'open' ? 'selected' : ''}>open</option>
                            <option ${complaint.status === 'in_progress' ? 'selected' : ''}>in_progress</option>
                            <option ${complaint.status === 'resolved' ? 'selected' : ''}>resolved</option>
                            <option ${complaint.status === 'closed' ? 'selected' : ''}>closed</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Admin Notes:</label>
                        <textarea id="admin-notes" placeholder="Add notes...">${complaint.admin_notes || ''}</textarea>
                    </div>
                    <button class="btn-submit" onclick="updateComplaint(${complaintId})">Update Complaint</button>
                `;
                
                document.getElementById('modal-body').innerHTML = html;
                document.getElementById('modal').classList.add('show');
            } catch (error) {
                showAlert('Error loading complaint', 'error');
            }
        }

        // Update complaint
        async function updateComplaint(complaintId) {
            try {
                const data = {
                    status: document.getElementById('status').value,
                    priority: document.getElementById('priority').value,
                    admin_notes: document.getElementById('admin-notes').value
                };
                
                const res = await fetch(`${API_BASE}/admin/complaints/${complaintId}/update`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify(data)
                });
                
                if (res.ok) {
                    showAlert('Complaint updated successfully', 'success');
                    closeModal();
                    loadComplaints();
                }
            } catch (error) {
                showAlert('Error updating complaint', 'error');
            }
        }

        // Show add hall form
        function showAddHallForm() {
            let html = `
                <h3>Add New Wedding Hall</h3>
                <div class="form-group">
                    <label>Hall Name:</label>
                    <input type="text" id="hall-name" placeholder="Enter hall name">
                </div>
                <div class="form-group">
                    <label>Location:</label>
                    <input type="text" id="hall-location" placeholder="Enter location">
                </div>
                <div class="form-group">
                    <label>Capacity:</label>
                    <input type="number" id="hall-capacity" placeholder="Enter capacity">
                </div>
                <div class="form-group">
                    <label>Price per Day (‚Çπ):</label>
                    <input type="number" id="hall-price" placeholder="Enter price">
                </div>
                <div class="form-group">
                    <label>Description:</label>
                    <textarea id="hall-description" placeholder="Enter description"></textarea>
                </div>
                <div class="form-group">
                    <label>Amenities (comma-separated):</label>
                    <input type="text" id="hall-amenities" placeholder="AC, Sound System, Parking">
                </div>
                <button class="btn-submit" onclick="addHall()">Add Hall</button>
            `;
            document.getElementById('modal-body').innerHTML = html;
            document.getElementById('modal').classList.add('show');
        }

        // Add hall
        async function addHall() {
            const data = {
                name: document.getElementById('hall-name').value,
                location: document.getElementById('hall-location').value,
                capacity: parseInt(document.getElementById('hall-capacity').value),
                price_per_day: parseFloat(document.getElementById('hall-price').value),
                description: document.getElementById('hall-description').value,
                amenities: document.getElementById('hall-amenities').value
            };
            
            try {
                const res = await fetch(`${API_BASE}/wedding-halls`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify(data)
                });
                
                if (res.ok) {
                    showAlert('Wedding hall added successfully', 'success');
                    closeModal();
                    loadHalls();
                }
            } catch (error) {
                showAlert('Error adding hall', 'error');
            }
        }

        // Similar functions for hotels and shopping items...
        function showAddHotelForm() {
            let html = `
                <h3>Add New Hotel Room</h3>
                <div class="form-group">
                    <label>Hotel Name:</label>
                    <input type="text" id="hotel-name" placeholder="Enter hotel name">
                </div>
                <div class="form-group">
                    <label>Room Name:</label>
                    <input type="text" id="room-name" placeholder="Enter room name">
                </div>
                <div class="form-group">
                    <label>Room Type:</label>
                    <select id="room-type">
                        <option>Single</option>
                        <option>Double</option>
                        <option>Suite</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Capacity:</label>
                    <input type="number" id="room-capacity" placeholder="Enter capacity">
                </div>
                <div class="form-group">
                    <label>Price per Night (‚Çπ):</label>
                    <input type="number" id="room-price" placeholder="Enter price">
                </div>
                <div class="form-group">
                    <label>Amenities:</label>
                    <input type="text" id="room-amenities" placeholder="AC, WiFi, TV">
                </div>
                <button class="btn-submit" onclick="addHotel()">Add Room</button>
            `;
            document.getElementById('modal-body').innerHTML = html;
            document.getElementById('modal').classList.add('show');
        }

        async function addHotel() {
            const data = {
                hotel_name: document.getElementById('hotel-name').value,
                name: document.getElementById('room-name').value,
                room_type: document.getElementById('room-type').value,
                capacity: parseInt(document.getElementById('room-capacity').value),
                price_per_night: parseFloat(document.getElementById('room-price').value),
                amenities: document.getElementById('room-amenities').value
            };
            
            try {
                const res = await fetch(`${API_BASE}/hotel-rooms`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify(data)
                });
                
                if (res.ok) {
                    showAlert('Hotel room added successfully', 'success');
                    closeModal();
                    loadHotels();
                }
            } catch (error) {
                showAlert('Error adding hotel room', 'error');
            }
        }

        function showAddItemForm() {
            let html = `
                <h3>Add New Shopping Item</h3>
                <div class="form-group">
                    <label>Item Name:</label>
                    <input type="text" id="item-name" placeholder="Enter item name">
                </div>
                <div class="form-group">
                    <label>Category:</label>
                    <input type="text" id="item-category" placeholder="Electronics, Fashion, etc">
                </div>
                <div class="form-group">
                    <label>Price (‚Çπ):</label>
                    <input type="number" id="item-price" placeholder="Enter price">
                </div>
                <div class="form-group">
                    <label>Stock:</label>
                    <input type="number" id="item-stock" placeholder="Enter stock" value="10">
                </div>
                <div class="form-group">
                    <label>Vendor:</label>
                    <input type="text" id="item-vendor" placeholder="Enter vendor name">
                </div>
                <div class="form-group">
                    <label>Description:</label>
                    <textarea id="item-description" placeholder="Enter description"></textarea>
                </div>
                <button class="btn-submit" onclick="addItem()">Add Item</button>
            `;
            document.getElementById('modal-body').innerHTML = html;
            document.getElementById('modal').classList.add('show');
        }

        async function addItem() {
            const data = {
                name: document.getElementById('item-name').value,
                category: document.getElementById('item-category').value,
                price: parseFloat(document.getElementById('item-price').value),
                stock: parseInt(document.getElementById('item-stock').value),
                vendor: document.getElementById('item-vendor').value,
                description: document.getElementById('item-description').value
            };
            
            try {
                const res = await fetch(`${API_BASE}/shopping-items`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify(data)
                });
                
                if (res.ok) {
                    showAlert('Shopping item added successfully', 'success');
                    closeModal();
                    loadShopping();
                }
            } catch (error) {
                showAlert('Error adding item', 'error');
            }
        }

        // Navigation
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function() {
                document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
                
                this.classList.add('active');
                const section = this.getAttribute('data-section');
                document.getElementById(section).classList.add('active');
                
                // Load data for the section
                if (section === 'users') loadUsers();
                else if (section === 'bookings') loadBookings();
                else if (section === 'contacts') loadContacts();
                else if (section === 'complaints') loadComplaints();
                else if (section === 'halls') loadHalls();
                else if (section === 'hotels') loadHotels();
                else if (section === 'shopping') loadShopping();
                else if (section === 'dashboard') loadDashboard();
            });
        });

        // Utilities
        function closeModal() {
            document.getElementById('modal').classList.remove('show');
        }

        function showAlert(message, type) {
            const alert = document.getElementById('alert');
            alert.textContent = message;
            alert.className = `alert ${type}`;
            setTimeout(() => {
                alert.className = 'alert';
            }, 3000);
        }

        function filterBookings() {
            // Implement search functionality
        }

        async function logout() {
            try {
                await fetch(`${API_BASE}/auth/logout`, {
                    method: 'POST',
                    credentials: 'include'
                });
                window.location.href = 'login.html';
            } catch (error) {
                alert('Logout error');
            }
        }

        // Initialize
        checkAuth();
        loadDashboard();

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('modal');
            if (event.target === modal) {
                closeModal();
            }
        }
    </script>
</body>
</html>
